(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=o(a);fetch(a.href,s)}})();const b="https://rickandmortyapi.com/api/character/",v="character.id=";async function N(t){const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}`);return e.json()}const d={characters:[],allLoaded:[],nextPageUrl:null,filters:{name:"",status:"",species:""}},x=()=>d;function w(t,{append:e=!1}={}){d.characters=e?[...d.characters,...t]:t,d.allLoaded=d.characters}function I(t){d.nextPageUrl=t}function F(t){d.filters={...d.filters,...t}}const r={body:document.body,divCharacters:document.getElementById("divCharacters"),filterName:document.getElementById("filterName"),filterStatus:document.getElementById("filterStatus"),filterSpecies:document.getElementById("filterSpecies"),loadMore:document.getElementById("loadMoreContainer"),status:document.getElementById("status"),detailCard:document.getElementById("card"),episodesCardList:document.getElementById("cardList")};function g(t=""){return`/rick-and-morty-explorer/${t}`}function m(t,e){e.forEach(o=>o.classList.remove("nav-btn--active")),t.classList.add("nav-btn--active")}function B({onHome:t,onFavorites:e}={}){if(!r.body)return;let o=document.querySelector("header"),n=document.getElementById("headerActions");if(!o||!n)if(o=document.querySelector('header[data-generated="true"]'),o)n=o.querySelector("#headerActions");else{o=document.createElement("header"),o.dataset.generated="true",o.className="w-full border-b border-slate-800 bg-slate-950/60 backdrop-blur";const l=document.createElement("div");l.className="container flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4";const f=document.createElement("div");f.innerHTML='<div class="text-lg font-bold">Rick and Morty Explorer</div><div class="subtle text-sm">Navegaci√≥n</div>',n=document.createElement("div"),n.id="headerActions",n.className="nav",l.append(f,n),o.appendChild(l),r.body.prepend(o)}if(!n)return;n.innerHTML="";const a=document.createElement("button");a.type="button",a.className="nav-btn",a.textContent="Inicio";const s=document.createElement("button");s.type="button",s.className="nav-btn",s.textContent="Favoritos";const i=document.createElement("button");i.type="button",i.className="nav-btn",i.textContent="Episodios";const c=[a,s,i];n.append(...c);const u=window.location.pathname;u.includes("/src/pages/episodes.html")?m(i,c):(u.includes("/src/pages/characterDetail.html"),m(a,c)),a.addEventListener("click",()=>{m(a,c),typeof t=="function"?t():window.location.href=g("")}),s.addEventListener("click",()=>{m(s,c),typeof e=="function"&&e()}),i.addEventListener("click",()=>{m(i,c),window.location.href=g("src/pages/episodes.html")})}function P(t="Cargando..."){r.status&&(r.status.className="status is-loading",r.status.textContent=t)}function M(t="Ha ocurrido un error."){r.status&&(r.status.className="status is-error",r.status.textContent=t)}function k(){r.status&&(r.status.className="status",r.status.textContent="")}function A(t,e){return!!localStorage.getItem(`${t}${e}`)}function $(t,e,o){const n=`${t}${e}`;return localStorage.getItem(n)?(localStorage.removeItem(n),!1):(localStorage.setItem(n,JSON.stringify(o)),!0)}function R(t){const e=[];for(let o=0;o<localStorage.length;o++){const n=localStorage.key(o);if(n?.startsWith(t))try{e.push(JSON.parse(localStorage.getItem(n)))}catch{}}return e}function T(t){return A(v,t)}function H(t,e){return $(v,t,e)}function O(){return R(v)}function y(t){if(r.divCharacters){if(r.divCharacters.innerHTML="",!Array.isArray(t)||t.length===0){const e=document.createElement("h3");e.className="text-lg font-semibold text-slate-200",e.textContent="No hemos encontrado ning√∫n resultado",r.divCharacters.appendChild(e);return}t.forEach(e=>{const o=document.createElement("article");o.className="card",o.dataset.id=e.id;const n=document.createElement("div");n.className="space-y-3 cursor-pointer";const a=document.createElement("img");a.src=e.image,a.alt=e.name,a.loading="lazy",a.className="w-full rounded-xl border border-slate-800";const s=document.createElement("div");s.className="flex items-start justify-between gap-3";const i=document.createElement("div");i.className="min-w-0";const c=document.createElement("h3");c.className="text-xl font-bold tracking-tight truncate",c.textContent=e.name;const u=document.createElement("p");u.className="text-sm text-slate-300",u.textContent=`${e.status}, ${e.gender}, ${e.species}`,i.append(c,u);const l=document.createElement("button");l.type="button",l.className="button button--ghost shrink-0",l.textContent=T(e.id)?"Favorito ‚ù§Ô∏è":"Favorito ü§ç",l.addEventListener("click",h=>{h.stopPropagation();const S=H(e.id,e);l.textContent=S?"Favorito ‚ù§Ô∏è":"Favorito ü§ç"}),s.append(i,l),n.append(a,s),n.addEventListener("click",()=>{window.location.href=g(`src/pages/characterDetail.html?id=${e.id}`)});const f=document.createElement("div");f.className="pt-2 flex justify-end";const p=document.createElement("button");p.type="button",p.className="button",p.textContent="Ver detalle",p.addEventListener("click",h=>{h.stopPropagation(),window.location.href=g(`src/pages/characterDetail.html?id=${e.id}`)}),f.appendChild(p),o.append(n,f),r.divCharacters.appendChild(o)})}}function U(t,e){if(!r.loadMore||(r.loadMore.innerHTML="",!t))return;const o=document.createElement("button");o.type="button",o.className="button",o.textContent="Cargar m√°s",o.addEventListener("click",()=>{typeof e=="function"&&e()}),r.loadMore.appendChild(o)}function C(t){if(!t)return;t.innerHTML="";const e=document.createElement("option");e.value="",e.textContent="Todo",t.appendChild(e)}function j(t){if(!r.filterStatus||!r.filterSpecies)return;const e=[...new Set(t.map(n=>n.status).filter(Boolean))],o=[...new Set(t.map(n=>n.species).filter(Boolean))];C(r.filterStatus),C(r.filterSpecies),e.forEach(n=>{const a=document.createElement("option");a.value=n.toLowerCase(),a.textContent=n,r.filterStatus.appendChild(a)}),o.forEach(n=>{const a=document.createElement("option");a.value=n.toLowerCase(),a.textContent=n,r.filterSpecies.appendChild(a)})}function L(t,e){let o=t;return e.name&&(o=o.filter(n=>n.name.toLowerCase().includes(e.name))),e.status&&(o=o.filter(n=>n.status.toLowerCase()===e.status)),e.species&&(o=o.filter(n=>n.species.toLowerCase()===e.species)),o}function q(t){r.filterName&&r.filterName.addEventListener("input",e=>{t?.({name:e.target.value.trim().toLowerCase()})}),r.filterStatus&&r.filterStatus.addEventListener("change",()=>{t?.({status:r.filterStatus.value})}),r.filterSpecies&&r.filterSpecies.addEventListener("change",()=>{t?.({species:r.filterSpecies.value.trim().toLowerCase()})})}async function E(t,{append:e=!1}={}){if(r.divCharacters)try{P("Cargando personajes...");const o=await N(t);I(o.info?.next??null),w(o.results,{append:e});const n=x();j(n.allLoaded);const a=L(n.allLoaded,n.filters);y(a),U(n.nextPageUrl,()=>{E(n.nextPageUrl,{append:!0})}),k()}catch(o){console.error(o),M("No se pudieron cargar los personajes. Revisa tu conexi√≥n o el endpoint.")}}B({onHome:()=>E(b),onFavorites:()=>y(O())});q(t=>{F(t);const e=x();y(L(e.allLoaded,e.filters))});E(b);
